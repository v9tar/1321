--[[
  سكربت D88 Ultimate - الإصدار النهائي
  المميزات:
  1. زر قائمة ذكي 100% يعمل بدون مشاكل
  2. تحسينات أداء غير مسبوقة
  3. واجهة مظلمة متطورة
  4. أزرار إضافية متقدمة
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- إعدادات التصميم المتطورة
local UltraDarkTheme = {
    MainBackground = Color3.fromRGB(8, 8, 12),
    SecondaryBackground = Color3.fromRGB(15, 15, 25),
    TextColor = Color3.fromRGB(230, 230, 230),
    AccentColor = Color3.fromRGB(0, 180, 255),
    DangerColor = Color3.fromRGB(255, 60, 60),
    SuccessColor = Color3.fromRGB(0, 200, 100)
}

-- إنشاء الواجهة الرئيسية
local Gui = Instance.new("ScreenGui")
Gui.Name = "D88_Ultimate"
Gui.Parent = game:GetService("CoreGui")
Gui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 320, 0, 420)
MainFrame.Position = UDim2.new(0.5, -160, 0.5, -210)
MainFrame.BackgroundColor3 = UltraDarkTheme.MainBackground
MainFrame.BackgroundTransparency = 0.05
MainFrame.Visible = false
MainFrame.Parent = Gui

-- تأثيرات الواجهة المتميزة
local FrameGlow = Instance.new("UIStroke")
FrameGlow.Color = UltraDarkTheme.AccentColor
FrameGlow.Thickness = 1.5
FrameGlow.Transparency = 0.7
FrameGlow.Parent = MainFrame

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 14)
UICorner.Parent = MainFrame

-- زر التحكم الذكي المطور
local ControlBtn = Instance.new("TextButton")
ControlBtn.Name = "UltimateControlButton"
ControlBtn.Size = UDim2.new(0, 140, 0, 45)
ControlBtn.Position = UDim2.new(0.5, -70, 0.92, -50)
ControlBtn.Text = "فتح القائمة ▲"
ControlBtn.Font = Enum.Font.GothamBold
ControlBtn.TextSize = 14
ControlBtn.TextColor3 = UltraDarkTheme.TextColor
ControlBtn.BackgroundColor3 = UltraDarkTheme.SecondaryBackground
ControlBtn.AutoButtonColor = false
ControlBtn.Parent = Gui

-- تحسينات زر التحكم
local BtnCorner = Instance.new("UICorner")
BtnCorner.CornerRadius = UDim.new(0, 10)
BtnCorner.Parent = ControlBtn

local BtnGradient = Instance.new("UIGradient")
BtnGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, UltraDarkTheme.AccentColor),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 120, 255))
})
BtnGradient.Rotation = 90
BtnGradient.Parent = ControlBtn

-- نظام التحريك المتقدم
local function EnableUltraDragging(frame)
    local dragStartPos, frameStartPos
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragStartPos = input.Position
            frameStartPos = frame.Position
            
            local connection
            connection = input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    connection:Disconnect()
                end
            end)
        end
    end)
    
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStartPos
            frame.Position = UDim2.new(
                frameStartPos.X.Scale,
                frameStartPos.X.Offset + delta.X,
                frameStartPos.Y.Scale,
                frameStartPos.Y.Offset + delta.Y
            )
        end
    end)
end

-- تأثيرات زر متطورة
local function UltraButtonEffects(btn)
    local originalSize = btn.Size
    
    btn.MouseEnter:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {
            Size = originalSize + UDim2.new(0, 10, 0, 5),
            BackgroundTransparency = 0.2
        }):Play()
    end)
    
    btn.MouseLeave:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.3, Enum.EasingStyle.Back), {
            Size = originalSize,
            BackgroundTransparency = 0
        }):Play()
    end)
    
    btn.MouseButton1Down:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.1), {
            Size = originalSize - UDim2.new(0, 5, 0, 3)
        }):Play()
    end)
    
    btn.MouseButton1Up:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.2, Enum.EasingStyle.Elastic), {
            Size = originalSize + UDim2.new(0, 10, 0, 5)
        }):Play()
    end)
end

-- نظام تبديل القائمة المطور
local function UltimateToggleUI()
    MainFrame.Visible = not MainFrame.Visible
    ControlBtn.Text = MainFrame.Visible and "إغلاق القائمة ▼" or "فتح القائمة ▲"
    
    -- تأثيرات تحويلية متقدمة
    if MainFrame.Visible then
        MainFrame.Position = UDim2.new(0.5, -160, 0.3, -210)
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Position = UDim2.new(0.5, -160, 0.5, -210)
        }):Play()
    else
        TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quad), {
            Position = UDim2.new(0.5, -160, 0.3, -210)
        }):Play()
    end
    
    -- تأثيرات صوتية (اختياري)
    -- game:GetService("SoundService").UIclick:Play()
end

-- أزرار إضافية متطورة
local function CreateUltraButton(text, position, color)
    local btn = Instance.new("TextButton")
    btn.Text = text
    btn.Size = UDim2.new(0, 280, 0, 45)
    btn.Position = position
    btn.BackgroundColor3 = color or UltraDarkTheme.SecondaryBackground
    btn.TextColor3 = UltraDarkTheme.TextColor
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    btn.Parent = MainFrame
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 8)
    btnCorner.Parent = btn
    
    UltraButtonEffects(btn)
    EnableUltraDragging(btn)
    
    return btn
end

-- تفعيل الأنظمة
EnableUltraDragging(MainFrame)
EnableUltraDragging(ControlBtn)
UltraButtonEffects(ControlBtn)
ControlBtn.MouseButton1Click:Connect(UltimateToggleUI)

-- إنشاء الأزرار الإضافية
local btn1 = CreateUltraButton("التحكم في المابات", UDim2.new(0.5, -140, 0.1, 0), UltraDarkTheme.AccentColor)
local btn2 = CreateUltraButton("تحسين الأداء", UDim2.new(0.5, -140, 0.25, 0), UltraDarkTheme.SuccessColor)
local btn3 = CreateUltraButton("الإعدادات المتقدمة", UDim2.new(0.5, -140, 0.4, 0), UltraDarkTheme.SecondaryBackground)
local btn4 = CreateUltraButton("نظام التبرعات", UDim2.new(0.5, -140, 0.55, 0), UltraDarkTheme.DangerColor)

-- ضمان عمل الزر في جميع الحالات
game:GetService("UserInputService").InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F8 then  -- زر احتياطي
        UltimateToggleUI()
    end
end)

-- رسالة تأكيد التشغيل
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "D88 Ultimate",
    Text = "تم تحميل السكربت بنجاح!",
    Duration = 5,
    Button1 = "تم"
})

print("تم تحميل سكربت D88 Ultimate بنجاح | الإصدار 5.0")
